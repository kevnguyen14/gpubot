import os
from multiprocessing import Pool

map = {
'bestbuy' : ['6465789', '6429434', '6432446', '6434198', '6432447', '6430623', '6430215', '6436192', '6436193', '6437910', '6445108', '6432656', '6432657', '6430624', '6429440', '6432400', '6430175', '6432445', '6430620', '6462198', '6436196', '6436223', '6432399', '6436191', '6436194', '6436219', '6432655', '6432658', '6430621', '6429442', '6438278', '6439299', '6439384', '6439127', '6437909', '6439128', '6439385', '6437912', '6439300', '6439301', '6462266', '6432654', '6432653', '6462173', '6454329', '6454688', '6439402', '6454689', '6460666', '6452573', '6460665', '6444444', '6442484', '6454318', '6454328', '6444445', '6444449', '6446660', '6452940', '6441172', '6442485', '6454319', '6457619', '6457994', '6460664', '6457993', '6457626', '6457632', '6457620', '6457624', '6457622', '6444358', '6449499', '6444716', '6445157', '6453896', '6453897', '6444357', '6442585', '6441020', '6441226', '6453267', '6453268', '6440913', '6442077', '6453894', '6453895', '6447182', '6462956', '6466561', '6466931', '6467289', '6466932', '6465805', '6466564', '6467840', '6467838', '6467782', '6467779', '6467500', '6467285', '6467781', '6467785', '6467788', '6467497', '6465803', '6468863', '6468910', '6468925', '6468928', '6468931', '6467808', '6470355', '6426149', '6430161'],
'amd' : ['5458372200', '5458373400', '5496921500', '5496921400', '5458372800'],
'gamestop' : ['B233678C', 'B252769B', 'B242868C', 'B252770C', 'B264495A', 'B252771B','B242881C', 'B264493B', '11135063', 'B252773E', 'B284701B', 'B252773F', 'B252773D', 'B294751A', 'B294752A', '11145170', '11145198', '11121604', '11121603', '11118702', '11138943', '11121602', '11135062', '11135067', '11118701', '11118700', '11112926', '11121601', '11118753', '11109446', '11112502', '11118752', '11118698', '11121600', '11108141', '11108140'],
'newegg' : ['N82E16868110289', 'N82E16868110291', 'N82E16868110298', 'N82E16868110297', 'N82E16868110299', 'N82E16868110290', 'N82E16868110294'],
'amazon' : ['B08HJQ182D', 'B08HBVX53D', 'B08HR9D2JS', 'B08HR5SXPS', 'B08HHDP9DW', 'B08HJLLF7G', 'B08HJS2JLJ', 'B08HJPDJTY', 'B08HR6FMF3', 'B08HVV2P4Z', 'B08HBTJMLJ', 'B08FC5L3RG', 'B08FC6MR62', 'B08HH5WF97', 'B08HHDP9DW', 'B08HBR7QBM', 'B08HBTJMLJ', 'B08HR5SXPS', 'B08HR7SV3M', 'B08HR3Y5GQ', 'B08HR3DPGW', 'B08HR55YB5', 'B08HR4RJ3Q', 'B08HR6FMF3', 'B08HJTH61J', 'B08HJS2JLJ', 'B08HBQWBHH', 'B08HBVX53D', 'B08HRBW6VB', 'B08HR9D2JS', 'B08HJRF2CN', 'B08HJPDJTY', 'B08HJGNJ81', 'B08HJLLF7G', 'B08HBJB7YD', 'B08HBF5L3K'],
'msi' : ['692', '691', '694', '693', '533', '588', '535']
}

def run_process(params):
    param_str = f"[{','.join(params)}]"
    os.system(f'python3.8 restcalls.py {param_str}')

if __name__ == '__main__':
    all_skus = []
    for key in map.keys():
        skus = map[key]
        n = 4
        # using list comprehension
        x = [skus[i:i + n] for i in range(0, len(skus), n)]
        for part in x:
            part.insert(0, key)
            all_skus.append(part)
    all_skus = tuple(all_skus)
    pool = Pool(processes=len(all_skus))
    pool.map(run_process, all_skus)